<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pillar 2: NexCo Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
    background-color: #f5f5f5;
    color: #333;
    line-height: 1.6;
  }
  #game {
    max-width: 700px;
    margin: auto;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  h1, h2 {
    color: #003366;
  }
  button {
    display: block;
    margin: 10px 0;
    padding: 10px;
    background: #0066cc;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    width: 100%;
  }
  button:hover {
    background: #004999;
  }
</style>
</head>
<body>

<div id="game">
  <h1>Pillar 2: NexCo Simulation</h1>
  <div id="content"></div>
</div>

<script>
const gameData = [
  {
    text: `<h2>Scenario 1: In Scope?</h2>
    <p>NexCo, a US-headquartered multinational, had consolidated revenue of €900m in 2022 and €1.05bn in 2023. It's now 2024. Are you in scope for Pillar 2?</p>`,
    choices: [
      { text: "Yes – the group exceeds €750m revenue threshold", feedback: "Correct. Two consecutive years above €750m means NexCo is in scope for Pillar 2 from 2024.", next: 1 },
      { text: "No – 2022 was below €750m so not in scope yet", feedback: "Incorrect. The OECD rules (and Australia's implementation) look at either of the two preceding fiscal years. 2023’s €1.05bn triggers 2024 scope.", next: 1 }
    ]
  },
  {
    text: `<h2>Scenario 2: QDMTT in Australia</h2>
    <p>NexCo Australia earns AUD 120m in FY2024, but after R&D credits and IP deductions, its ETR is 11%. Australia has implemented a Qualified Domestic Minimum Top-up Tax (QDMTT). What do you do?</p>`,
    choices: [
      { text: "File a QDMTT return and pay top-up tax in Australia", feedback: "Correct. Paying QDMTT locally prevents other jurisdictions from collecting the top-up tax.", next: 2 },
      { text: "Wait for US to implement IIR", feedback: "Risky. Delay may leave you exposed to UTPR from other countries, as US IIR is not yet in force.", next: 2 },
      { text: "Ignore – Australia’s headline rate is already high", feedback: "Incorrect. Pillar 2 uses effective tax rate; here it's 11%, so QDMTT applies.", next: 2 }
    ]
  },
  {
    text: `<h2>Scenario 3: UTPR Risk</h2>
    <p>NexCo Singapore earns profits taxed at an ETR of 5%. Singapore has no QDMTT. The US hasn’t implemented IIR. Can Australia apply UTPR to NexCo's Australian operations?</p>`,
    choices: [
      { text: "Yes – Australia can deny deductions under UTPR rules", feedback: "Correct. Australia's UTPR allows deduction denial to collect the top-up tax where no other Pillar 2 mechanism applies.", next: 3 },
      { text: "No – UTPR only applies to low-taxed Australian profits", feedback: "Incorrect. UTPR can apply to group profits earned anywhere if not taxed to the minimum level.", next: 3 }
    ]
  },
  {
    text: `<h2>Debrief & Cheat Sheet</h2>
    <p>Well done! Here’s your Pillar 2 summary:</p>
    <ul>
      <li><strong>Scope:</strong> Applies to MNEs with €750m+ consolidated revenue in at least one of the two preceding fiscal years.</li>
      <li><strong>QDMTT:</strong> Lets Australia collect top-up tax locally, preventing other countries from collecting it.</li>
      <li><strong>UTPR:</strong> Allows deduction denial to collect top-up tax if IIR or QDMTT hasn’t addressed low-taxed profits.</li>
      <li><strong>Effective Tax Rate:</strong> Based on covered taxes / Pillar 2 income – not just headline rate.</li>
    </ul>
    <p>Replay anytime to test different decisions.</p>`
  }
];

let currentScenario = 0;

function renderScenario() {
  const scenario = gameData[currentScenario];
  let html = scenario.text;
  if (scenario.choices) {
    scenario.choices.forEach((choice, index) => {
      html += `<button onclick="chooseOption(${index})">${choice.text}</button>`;
    });
  }
  document.getElementById("content").innerHTML = html;
}

function chooseOption(choiceIndex) {
  const choice = gameData[currentScenario].choices[choiceIndex];
  alert(choice.feedback);
  currentScenario = choice.next;
  renderScenario();
}

renderScenario();
</script>

</body>
</html>
